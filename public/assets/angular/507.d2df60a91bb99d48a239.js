(self.webpackChunknguide_pricelist_ui=self.webpackChunknguide_pricelist_ui||[]).push([[507],{6507:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ResourcesModule:()=>st});var o=i(8583),s=i(4511),n=i(7029),r=i(3289),l=i(739),a=i(8550),c=i(7716),u=i(264),d=i(1873),h=i(8272),p=i(3679),f=i(6215),m=i(5435),g=i(8935),b=i(1103),v=i(7238),w=i(7435);const _=function(e){return{dropdown:e}},y=["*"];let x=(()=>{class e{constructor(){this.autoClose=!0,this.insideClick=!1,this.isAnimated=!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=(0,c.Yz7)({factory:function(){return new e},token:e,providedIn:"root"}),e})(),C=(()=>{class e{constructor(){this.direction="down",this.autoClose=!0,this.insideClick=!1,this.isAnimated=!1,this.isOpenChange=new c.vpe,this.isDisabledChange=new c.vpe,this.toggleClick=new c.vpe,this.dropdownMenu=new Promise(e=>{this.resolveDropdownMenu=e})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})();const Z=[(0,v.oB)({height:0,overflow:"hidden"}),(0,v.jt)("220ms cubic-bezier(0, 0, 0.2, 1)",(0,v.oB)({height:"*",overflow:"hidden"}))];let N=(()=>{class e{constructor(e,t,i,o,s){this._state=e,this.cd=t,this._renderer=i,this._element=o,this.isOpen=!1,this._factoryDropDownAnimation=s.build(Z),this._subscription=e.isOpenChange.subscribe(e=>{this.isOpen=e;const t=this._element.nativeElement.querySelector(".dropdown-menu");this._renderer.addClass(this._element.nativeElement.querySelector("div"),"open"),t&&!(0,b.XA)()&&(this._renderer.addClass(t,"show"),t.classList.contains("dropdown-menu-right")&&(this._renderer.setStyle(t,"left","auto"),this._renderer.setStyle(t,"right","0")),"up"===this.direction&&(this._renderer.setStyle(t,"top","auto"),this._renderer.setStyle(t,"transform","translateY(-101%)"))),t&&this._state.isAnimated&&this._factoryDropDownAnimation.create(t).play(),this.cd.markForCheck(),this.cd.detectChanges()})}get direction(){return this._state.direction}_contains(e){return this._element.nativeElement.contains(e)}ngOnDestroy(){this._subscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(C),c.Y36(c.sBO),c.Y36(c.Qsj),c.Y36(c.SBq),c.Y36(v._j))},e.\u0275cmp=c.Xpm({type:e,selectors:[["bs-dropdown-container"]],hostAttrs:[2,"display","block","position","absolute","z-index","1040"],ngContentSelectors:y,decls:2,vars:9,consts:[[3,"ngClass"]],template:function(e,t){1&e&&(c.F$t(),c.TgZ(0,"div",0),c.Hsn(1),c.qZA()),2&e&&(c.ekj("dropup","up"===t.direction)("show",t.isOpen)("open",t.isOpen),c.Q6J("ngClass",c.VKq(7,_,"down"===t.direction)))},directives:[o.mk],encapsulation:2,changeDetection:0}),e})(),A=(()=>{class e{constructor(e,t,i,o,s,n,r){this._elementRef=e,this._renderer=t,this._viewContainerRef=i,this._cis=o,this._state=s,this._config=n,this.dropup=!1,this._isInlineOpen=!1,this._isDisabled=!1,this._subscriptions=[],this._isInited=!1,this._state.autoClose=this._config.autoClose,this._state.insideClick=this._config.insideClick,this._state.isAnimated=this._config.isAnimated,this._factoryDropDownAnimation=r.build(Z),this._dropdown=this._cis.createLoader(this._elementRef,this._viewContainerRef,this._renderer).provide({provide:C,useValue:this._state}),this.onShown=this._dropdown.onShown,this.onHidden=this._dropdown.onHidden,this.isOpenChange=this._state.isOpenChange}set autoClose(e){this._state.autoClose=e}get autoClose(){return this._state.autoClose}set isAnimated(e){this._state.isAnimated=e}get isAnimated(){return this._state.isAnimated}set insideClick(e){this._state.insideClick=e}get insideClick(){return this._state.insideClick}set isDisabled(e){this._isDisabled=e,this._state.isDisabledChange.emit(e),e&&this.hide()}get isDisabled(){return this._isDisabled}get isOpen(){return this._showInline?this._isInlineOpen:this._dropdown.isShown}set isOpen(e){e?this.show():this.hide()}get isBs4(){return!(0,b.XA)()}get _showInline(){return!this.container}ngOnInit(){this._isInited||(this._isInited=!0,this._dropdown.listen({outsideClick:!1,triggers:this.triggers,show:()=>this.show()}),this._subscriptions.push(this._state.toggleClick.subscribe(e=>this.toggle(e))),this._subscriptions.push(this._state.isDisabledChange.pipe((0,m.h)(e=>e)).subscribe(()=>this.hide())))}show(){if(!this.isOpen&&!this.isDisabled)return this._showInline?(this._inlinedMenu||this._state.dropdownMenu.then(e=>{this._dropdown.attachInline(e.viewContainer,e.templateRef),this._inlinedMenu=this._dropdown._inlineViewRef,this.addBs4Polyfills(),this._inlinedMenu&&this._renderer.addClass(this._inlinedMenu.rootNodes[0].parentNode,"open"),this.playAnimation()}).catch(),this.addBs4Polyfills(),this._isInlineOpen=!0,this.onShown.emit(!0),this._state.isOpenChange.emit(!0),void this.playAnimation()):void this._state.dropdownMenu.then(e=>{const t=this.dropup||void 0!==this.dropup&&this.dropup;this._state.direction=t?"up":"down";const i=this.placement||(t?"top start":"bottom start");this._dropdown.attach(N).to(this.container).position({attachment:i}).show({content:e.templateRef,placement:i}),this._state.isOpenChange.emit(!0)}).catch()}hide(){this.isOpen&&(this._showInline?(this.removeShowClass(),this.removeDropupStyles(),this._isInlineOpen=!1,this.onHidden.emit(!0)):this._dropdown.hide(),this._state.isOpenChange.emit(!1))}toggle(e){return this.isOpen||!e?this.hide():this.show()}_contains(e){return this._elementRef.nativeElement.contains(e.target)||this._dropdown.instance&&this._dropdown.instance._contains(e.target)}ngOnDestroy(){for(const e of this._subscriptions)e.unsubscribe();this._dropdown.dispose()}addBs4Polyfills(){(0,b.XA)()||(this.addShowClass(),this.checkRightAlignment(),this.addDropupStyles())}playAnimation(){this._state.isAnimated&&this._inlinedMenu&&setTimeout(()=>{this._inlinedMenu&&this._factoryDropDownAnimation.create(this._inlinedMenu.rootNodes[0]).play()})}addShowClass(){this._inlinedMenu&&this._inlinedMenu.rootNodes[0]&&this._renderer.addClass(this._inlinedMenu.rootNodes[0],"show")}removeShowClass(){this._inlinedMenu&&this._inlinedMenu.rootNodes[0]&&this._renderer.removeClass(this._inlinedMenu.rootNodes[0],"show")}checkRightAlignment(){if(this._inlinedMenu&&this._inlinedMenu.rootNodes[0]){const e=this._inlinedMenu.rootNodes[0].classList.contains("dropdown-menu-right");this._renderer.setStyle(this._inlinedMenu.rootNodes[0],"left",e?"auto":"0"),this._renderer.setStyle(this._inlinedMenu.rootNodes[0],"right",e?"0":"auto")}}addDropupStyles(){this._inlinedMenu&&this._inlinedMenu.rootNodes[0]&&(this._renderer.setStyle(this._inlinedMenu.rootNodes[0],"top",this.dropup?"auto":"100%"),this._renderer.setStyle(this._inlinedMenu.rootNodes[0],"transform",this.dropup?"translateY(-101%)":"translateY(0)"),this._renderer.setStyle(this._inlinedMenu.rootNodes[0],"bottom","auto"))}removeDropupStyles(){this._inlinedMenu&&this._inlinedMenu.rootNodes[0]&&(this._renderer.removeStyle(this._inlinedMenu.rootNodes[0],"top"),this._renderer.removeStyle(this._inlinedMenu.rootNodes[0],"transform"),this._renderer.removeStyle(this._inlinedMenu.rootNodes[0],"bottom"))}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(c.SBq),c.Y36(c.Qsj),c.Y36(c.s_b),c.Y36(g.oj),c.Y36(C),c.Y36(x),c.Y36(v._j))},e.\u0275dir=c.lG2({type:e,selectors:[["","bsDropdown",""],["","dropdown",""]],hostVars:6,hostBindings:function(e,t){2&e&&c.ekj("dropup",t.dropup)("open",t.isOpen)("show",t.isOpen&&t.isBs4)},inputs:{dropup:"dropup",autoClose:"autoClose",isAnimated:"isAnimated",insideClick:"insideClick",isDisabled:"isDisabled",isOpen:"isOpen",placement:"placement",triggers:"triggers",container:"container"},outputs:{onShown:"onShown",onHidden:"onHidden",isOpenChange:"isOpenChange"},exportAs:["bs-dropdown"],features:[c._Bn([C])]}),e})(),I=(()=>{class e{constructor(e,t,i){e.resolveDropdownMenu({templateRef:i,viewContainer:t})}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(C),c.Y36(c.s_b),c.Y36(c.Rgc))},e.\u0275dir=c.lG2({type:e,selectors:[["","bsDropdownMenu",""],["","dropdownMenu",""]],exportAs:["bs-dropdown-menu"]}),e})(),k=(()=>{class e{constructor(e,t,i,o,s){this._changeDetectorRef=e,this._dropdown=t,this._element=i,this._renderer=o,this._state=s,this.isOpen=!1,this._subscriptions=[],this._subscriptions.push(this._state.isOpenChange.subscribe(e=>{this.isOpen=e,e?(this._documentClickListener=this._renderer.listen("document","click",e=>{!this._state.autoClose||2===e.button||this._element.nativeElement.contains(e.target)||this._state.insideClick&&this._dropdown._contains(e)||(this._state.toggleClick.emit(!1),this._changeDetectorRef.detectChanges())}),this._escKeyUpListener=this._renderer.listen(this._element.nativeElement,"keyup.esc",()=>{this._state.autoClose&&(this._state.toggleClick.emit(!1),this._changeDetectorRef.detectChanges())})):(this._documentClickListener&&this._documentClickListener(),this._escKeyUpListener&&this._escKeyUpListener())})),this._subscriptions.push(this._state.isDisabledChange.subscribe(e=>this.isDisabled=e||void 0))}onClick(e){e.stopPropagation(),this.isDisabled||this._state.toggleClick.emit(!0)}ngOnDestroy(){this._documentClickListener&&this._documentClickListener(),this._escKeyUpListener&&this._escKeyUpListener();for(const e of this._subscriptions)e.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(c.sBO),c.Y36(A),c.Y36(c.SBq),c.Y36(c.Qsj),c.Y36(C))},e.\u0275dir=c.lG2({type:e,selectors:[["","bsDropdownToggle",""],["","dropdownToggle",""]],hostVars:3,hostBindings:function(e,t){1&e&&c.NdJ("click",function(e){return t.onClick(e)}),2&e&&c.uIk("aria-haspopup",!0)("aria-expanded",t.isOpen)("disabled",t.isDisabled)},exportAs:["bs-dropdown-toggle"]}),e})(),O=(()=>{class e{static forRoot(){return{ngModule:e,providers:[g.oj,w.sA,C]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[o.ez]]}),e})();var S=i(3500);function T(e,t){if(1&e&&(c.TgZ(0,"span",6),c._uU(1),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.hij(" ",e.nrFilters," ")}}function q(e,t){if(1&e){const e=c.EpF();c.ynx(0),c.TgZ(1,"form",9),c.NdJ("ngSubmit",function(){return c.CHM(e),c.oxw(2).submit()}),c._UZ(2,"formly-form",10),c.qZA(),c.TgZ(3,"button",11),c.NdJ("click",function(){return c.CHM(e),c.oxw(2).submit()}),c._uU(4,"Search"),c.qZA(),c.TgZ(5,"button",12),c.NdJ("click",function(){return c.CHM(e),c.oxw(2).reset()}),c._uU(6,"Reset"),c.qZA(),c.BQk()}if(2&e){const e=c.oxw(2);c.xp6(1),c.Q6J("formGroup",e.form),c.xp6(1),c.Q6J("model",e.model)("fields",e.fields)("options",e.options)("form",e.form)}}function J(e,t){if(1&e&&(c.TgZ(0,"div",7),c.YNc(1,q,7,5,"ng-container",8),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngIf",e.form&&e.fields)}}let Y=(()=>{class e{constructor(e){this.resourcesService=e,this.resourceName="",this.filtersChange=new c.vpe,this.form=new p.cw({}),this.model={},this.options={},this.fields=[],this.defaultLocale="nl"}get nrFilters(){return this.resourcesService.nrNonEmptyFilters(this.form.value)}ngOnInit(){}ngOnChanges(e){var t;(null===(t=null==e?void 0:e.resourceName)||void 0===t?void 0:t.currentValue)&&this.resourcesService.getFilters(e.resourceName.currentValue).subscribe(e=>{this.defaultLocale=e.defaultLocale,this.originalSchema=e.schema,this.fields=this.mapFields(JSON.parse(JSON.stringify(e.schema)),this.defaultLocale)})}mapFields(e,t){return e.map(e=>{var i;return e.hasOwnProperty("fieldGroup")?e.fieldGroup=this.mapFields(e.fieldGroup,t):"repeat"===e.type&&(e.fieldArray.fieldGroup=this.mapFields(e.fieldArray.fieldGroup,t)),"translatable-input"!==e.type&&"translatable-textarea"!==e.type||((null===(i=e.templateOptions)||void 0===i?void 0:i.language)?e.templateOptions.language.next(t):e.templateOptions.language=new f.X(t),e.wrappers=[...e.wrappers||[],"translatable"]),e.templateOptions.defaultLocale=this.defaultLocale,e})}reset(){this.form.reset(),this.submit()}submit(){this.form.value&&this.fields&&this.filtersChange.emit(this.resourcesService.getFilterableOptions(this.form.value,this.fields))}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(s.z6))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-filters"]],inputs:{resourceName:"resourceName",filters:"filters"},outputs:{filtersChange:"filtersChange"},features:[c.TTD],decls:6,vars:2,consts:[["dropdown","","placement","bottom right","container","body",1,"btn-group",3,"insideClick"],["id","button-basic","dropdownToggle","","type","button","aria-controls","dropdown-basic","title","Filter",1,"btn","btn-primary","dropdown-toggle"],[1,"bi","bi-funnel"],[1,"caret"],["class","position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger",4,"ngIf"],["id","dropdown-basic","class","dropdown-menu p-2 filter-dropdown dropdown-menu-right","role","menu","aria-labelledby","button-basic",4,"dropdownMenu"],[1,"position-absolute","top-0","start-100","translate-middle","badge","rounded-pill","bg-danger"],["id","dropdown-basic","role","menu","aria-labelledby","button-basic",1,"dropdown-menu","p-2","filter-dropdown","dropdown-menu-right"],[4,"ngIf"],[3,"formGroup","ngSubmit"],[3,"model","fields","options","form"],[1,"btn","btn-success","mt-2","w-100",3,"click"],[1,"btn","btn-danger","mt-2","w-100",3,"click"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c.TgZ(1,"button",1),c._UZ(2,"i",2),c._UZ(3,"span",3),c.YNc(4,T,2,1,"span",4),c.qZA(),c.YNc(5,J,2,1,"div",5),c.qZA()),2&e&&(c.Q6J("insideClick",!0),c.xp6(4),c.Q6J("ngIf",t.nrFilters>0))},directives:[A,k,o.O5,I,p._Y,p.JL,p.sg,S.T7],styles:["[_nghost-%COMP%]     .form-group label{font-size:.8rem}[_nghost-%COMP%]     .form-group .form-control{min-height:calc(1.5em + .5rem + 2px);padding:.25rem .5rem;font-size:.875rem;border-radius:.2rem}"]}),e})();const M=function(){return["create"]};function Q(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",2),c.TgZ(1,"div",3),c.TgZ(2,"h2",4),c._uU(3),c.qZA(),c.TgZ(4,"div",5),c.TgZ(5,"app-filters",6),c.NdJ("filtersChange",function(t){return c.CHM(e),c.oxw().filtersChange(t)}),c.qZA(),c.TgZ(6,"a",7),c._UZ(7,"i",8),c._uU(8," Create new"),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&e){const e=c.oxw();c.xp6(3),c.Oqu(e.resourceInfo.pluralLabel),c.xp6(2),c.Q6J("resourceName",e.resourceName),c.xp6(1),c.Q6J("routerLink",c.DdM(3,M))}}function D(e,t){1&e&&c.GkF(0)}function U(e,t){if(1&e&&(c.TgZ(0,"div",17),c._uU(1),c.qZA()),2&e){const e=c.oxw().value,t=c.oxw(3);c.Q6J("title",t.getTranslatedValue(e)),c.xp6(1),c.Oqu(t.getTranslatedValue(e))}}function L(e,t){if(1&e&&(c.TgZ(0,"div",17),c._uU(1),c.qZA()),2&e){const e=c.oxw().value;c.Q6J("title",e),c.xp6(1),c.Oqu(e)}}function F(e,t){if(1&e&&(c.YNc(0,D,1,0,"ng-container",14),c.YNc(1,U,2,2,"ng-template",null,15,c.W1O),c.YNc(3,L,2,2,"ng-template",null,16,c.W1O)),2&e){const e=c.MAs(2),t=c.MAs(4),i=c.oxw().$implicit;c.Q6J("ngIf",null==i?null:i.translatable)("ngIfThen",e)("ngIfElse",t)}}function E(e,t){if(1&e&&(c.TgZ(0,"ngx-datatable-column",13),c.YNc(1,F,5,3,"ng-template",12),c.qZA()),2&e){const e=t.$implicit;c.Q6J("name",e.name)("path",e.path)("prop",e.prop)("draggable",e.draggable)("resizeable",e.resizeable)("sortable",e.sortable)("flexGrow",e.flexGrow)}}function R(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"a",25),c.NdJ("click",function(){c.CHM(e);const t=c.oxw().row;return c.oxw(2).clone(t.id)}),c._UZ(1,"i",26),c._uU(2," Clone"),c.qZA()}}const H=function(e){return[e,"edit"]};function P(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",18),c.TgZ(1,"div",19),c.TgZ(2,"a",20),c._UZ(3,"i",21),c._uU(4," Edit"),c.qZA(),c.YNc(5,R,3,0,"a",22),c.TgZ(6,"a",23),c.NdJ("click",function(){const t=c.CHM(e).row;return c.oxw(2).remove(t.id)}),c._UZ(7,"i",24),c._uU(8," Remove"),c.qZA(),c.qZA(),c.qZA()}if(2&e){const e=t.row,i=c.oxw(2);c.xp6(2),c.Q6J("routerLink",c.VKq(2,H,e.id)),c.xp6(3),c.Q6J("ngIf",null==i.config?null:i.config.clonable)}}function j(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"ngx-datatable",9),c.NdJ("sort",function(t){return c.CHM(e),c.oxw().onSort(t)})("page",function(t){return c.CHM(e),c.oxw().onPaginate(t)}),c.YNc(1,E,2,7,"ngx-datatable-column",10),c.TgZ(2,"ngx-datatable-column",11),c.YNc(3,P,9,4,"ng-template",12),c.qZA(),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("rows",e.rows)("headerHeight","auto")("footerHeight","auto")("rowHeight","auto")("columnMode",e.ColumnMode.flex)("limit",e.listResponse.per_page)("count",e.listResponse.total)("offset",e.listResponse.current_page-1)("externalSorting",!0)("externalPaging",!0)("loadingIndicator",e.loadingIndicator),c.xp6(1),c.Q6J("ngForOf",e.columns),c.xp6(1),c.Q6J("name","Actions")("draggable",!1)("resizeable",!1)("sortable",!1)("flexGrow",2)}}let B=(()=>{class e extends r.i{constructor(e,t,i,o,s){super(t,s),this.activatedRoute=e,this.resourcesService=t,this.alertsService=i,this.breadcrumbService=o,this.tableService=s,this.ColumnMode=a.hq}ngOnInit(){(0,l.aj)([this.activatedRoute.paramMap,this.activatedRoute.queryParamMap]).subscribe(([e,t])=>{this.resourceName=e.get("name"),this.filtersData=JSON.parse(t.get("filters","{}")),this.resourceName&&this.resourcesService.getResourceInfo(this.resourceName).subscribe(e=>{this.resourceInfo=e,this.initBreadcrumb(),this.resourceName&&this.loadData(this.resourceName,new s.CE({resource:this.resourceName,filters:this.filtersData}))})})}filtersChange(e){this.resourceName&&e&&this.onFilter(e)}remove(e){confirm("Are you sure you want to remove this item?")&&this.resourceName&&this.resourcesService.removeResource(this.resourceName,e).subscribe(e=>{this.resourceName&&(this.alertsService.show(n.NK.success,"Resource Removed!"),this.resourcesService.onTableData.next(new s.CE({resource:this.resourceName,sorting:this.sort,page:this.page,filters:this.filters})))})}initBreadcrumb(){var e;this.breadcrumbService.setBreadcrumb([{label:"Home",path:["/dashboard"]},{label:(null===(e=this.resourceInfo)||void 0===e?void 0:e.pluralLabel)||"Resource",path:[`/resources/${this.resourceName}`]}]),this.breadcrumbService.update()}clone(e){confirm("Are you sure you want to clone this item?")&&this.resourceName&&this.resourcesService.cloneResrouce(this.resourceName,e).subscribe(e=>{this.resourceName&&(this.alertsService.show(n.NK.success,"Resource Cloned!"),this.resourcesService.onTableData.next(new s.CE({resource:this.resourceName,sorting:this.sort,page:this.page,filters:this.filters})))})}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(u.gz),c.Y36(s.z6),c.Y36(n.ml),c.Y36(d.p),c.Y36(h.w))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-list"]],features:[c.qOj],decls:2,vars:2,consts:[["class","pt-4 row sticky-top bg-white overflow-hidden pb-2 border-bottom",4,"ngIf"],["class","material m-0 mb-4",3,"rows","headerHeight","footerHeight","rowHeight","columnMode","limit","count","offset","externalSorting","externalPaging","loadingIndicator","sort","page",4,"ngIf"],[1,"pt-4","row","sticky-top","bg-white","overflow-hidden","pb-2","border-bottom"],[1,"row"],[1,"col-9"],[1,"col-3","text-end"],[1,"me-2",3,"resourceName","filtersChange"],[1,"btn","btn-success",3,"routerLink"],[1,"bi","bi-plus-circle"],[1,"material","m-0","mb-4",3,"rows","headerHeight","footerHeight","rowHeight","columnMode","limit","count","offset","externalSorting","externalPaging","loadingIndicator","sort","page"],[3,"name","path","prop","draggable","resizeable","sortable","flexGrow",4,"ngFor","ngForOf"],[3,"name","draggable","resizeable","sortable","flexGrow"],["ngx-datatable-cell-template",""],[3,"name","path","prop","draggable","resizeable","sortable","flexGrow"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"text-truncate","pr-2",3,"title"],[1,"text-end"],[1,"btn-group"],[1,"btn","btn-success","btn-sm",3,"routerLink"],[1,"bi","bi-pencil"],["class","btn btn-success btn-sm",3,"click",4,"ngIf"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"bi","bi-trash"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"bi","bi-clipboard-plus"]],template:function(e,t){1&e&&(c.YNc(0,Q,9,4,"div",0),c.YNc(1,j,4,17,"ngx-datatable",1)),2&e&&(c.Q6J("ngIf",t.resourceInfo),c.xp6(1),c.Q6J("ngIf",!t.loadingIndicator))},directives:[o.O5,Y,u.yS,a.nE,o.sg,a.UC,a.vq],styles:[""]}),e})();var V=i(5796),z=i(7579);function G(e,t){if(1&e&&(c.TgZ(0,"option",10),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("value",e.key),c.xp6(1),c.Oqu(e.value)}}function $(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",11),c.NdJ("click",function(){return c.CHM(e),c.oxw(2).download()}),c._UZ(1,"i",12),c._uU(2," Download Latest "),c.qZA()}if(2&e){const e=c.oxw(2);c.Q6J("disabled",!e.canDownload)}}function X(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",11),c.NdJ("click",function(){return c.CHM(e),c.oxw(2).generatePdf()}),c._UZ(1,"i",13),c._uU(2," Generate PDF "),c.qZA()}if(2&e){const e=c.oxw(2);c.Q6J("disabled",e.isProcessing)}}function K(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",14),c.NdJ("click",function(){return c.CHM(e),c.oxw(2).setPrices()}),c._UZ(1,"i",15),c._uU(2," Set Prices "),c.qZA()}}function W(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",16),c.NdJ("click",function(){return c.CHM(e),c.oxw(2).submit()}),c._UZ(1,"i",17),c._uU(2," Save "),c.qZA()}if(2&e){const e=c.oxw(2);c.Q6J("disabled",!e.form.valid)}}function ee(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"form",18),c.NdJ("ngSubmit",function(){return c.CHM(e),c.oxw(2).submit()}),c._UZ(1,"formly-form",19),c.qZA()}if(2&e){const e=c.oxw(2);c.Q6J("formGroup",e.form),c.xp6(1),c.Q6J("model",e.model)("fields",e.fields)("options",e.options)("form",e.form)}}function te(e,t){if(1&e&&(c.ynx(0),c.TgZ(1,"div",1),c.TgZ(2,"h2",2),c._uU(3),c.qZA(),c.TgZ(4,"div",3),c.TgZ(5,"select",4),c.YNc(6,G,2,2,"option",5),c.qZA(),c.YNc(7,$,3,1,"button",6),c.YNc(8,X,3,1,"button",6),c.YNc(9,K,3,0,"button",7),c.YNc(10,W,3,1,"button",8),c.qZA(),c.qZA(),c.YNc(11,ee,2,5,"form",9),c.BQk()),2&e){const e=c.oxw();c.xp6(3),c.AsE("","create"===e.action?"Create":"Edit"," ",e.resourceInfo.label,""),c.xp6(2),c.Q6J("formControl",e.languageControl),c.xp6(1),c.Q6J("ngForOf",e.locales),c.xp6(1),c.Q6J("ngIf",e.isPriceList),c.xp6(1),c.Q6J("ngIf",e.isPriceList),c.xp6(1),c.Q6J("ngIf",e.isPriceList),c.xp6(1),c.Q6J("ngIf",e.form),c.xp6(1),c.Q6J("ngIf",!e.hideForm)}}let ie=(()=>{class e{constructor(e,t,i,o,s,n,r,l){this.activatedRoute=e,this.router=t,this.formlyConfig=i,this.formService=o,this.loadingService=s,this.alertsService=n,this.breadcrumbService=r,this.resourcesService=l,this.resourceName=null,this.resourceId=null,this.resourceInfo=null,this.form=new p.cw({}),this.languageControl=new p.NI(""),this.options={},this.model={},this.fields=[],this.language="en",this.locales=[],this.defaultLocale="nl",this.hideForm=!1,this.isProcessing=!0,this.canDownload=!1,this.downloadUrl="",this.poll$=null}ngOnInit(){this.activatedRoute.paramMap.subscribe(e=>{this.resourceName=e.get("name"),this.resourceId=e.get("id"),this.loadData()}),this.languageControl.valueChanges.subscribe(e=>{var t;e&&this.originalSchema&&this.originalSchema.length>0&&(this.loadingService.startLoading("select-language"),setTimeout(()=>{this.fields=this.mapFields(JSON.parse(JSON.stringify(this.originalSchema)),e),this.loadingService.endLoading("select-language")},100)),e&&this.isPriceList&&this.resourceId&&(null===(t=this.poll$)||void 0===t||t.unsubscribe(),this.poll$=this.resourcesService.pollDownload(this.resourceId,e).subscribe(e=>{e&&("success"===(null==e?void 0:e.status)&&(null==e?void 0:e.url)?(this.canDownload=!0,this.downloadUrl=e.url):(this.canDownload=!1,this.downloadUrl=""),this.isProcessing="progress"===(null==e?void 0:e.status))}))})}get isPriceList(){return"priceList"===this.resourceName}loadData(){this.resourceName&&this.resourcesService.getResourceInfo(this.resourceName).subscribe(e=>{this.resourceInfo=e,this.initBreadcrumb(),this.resourceName&&(this.resourceId?this.resourcesService.getEditResourceSchema(this.resourceName,this.resourceId).subscribe(e=>{this.locales=this.mapLocales(e.locales),this.defaultLocale=e.defaultLocale,this.languageControl.setValue(this.defaultLocale),this.model=e.data||{},this.originalSchema=e.schema,this.fields=this.mapFields(JSON.parse(JSON.stringify(e.schema)),this.languageControl.value)}):this.resourcesService.getCreateResourceSchema(this.resourceName).subscribe(e=>{this.locales=this.mapLocales(e.locales),this.defaultLocale=e.defaultLocale,this.languageControl.setValue(this.defaultLocale,{emitEvent:!1}),this.model={},this.originalSchema=e.schema,this.fields=this.mapFields(JSON.parse(JSON.stringify(e.schema)),this.languageControl.value)}))})}mapLocales(e){const t=[];for(const i in e)t.push({key:i,value:e[i]});return t}get action(){return this.resourceId?"edit":"create"}mapFields(e,t){return e.map(e=>{var i;return e.hasOwnProperty("fieldGroup")?e.fieldGroup=this.mapFields(e.fieldGroup,t):"repeat"===e.type&&(e.fieldArray.fieldGroup=this.mapFields(e.fieldArray.fieldGroup,t)),t!==this.defaultLocale&&("translatable-input"!==e.type&&"translatable-textarea"!==e.type&&"images"!==e.type||(e.templateOptions.required=!1)),"translatable-input"!==e.type&&"translatable-textarea"!==e.type&&"images"!==e.type||(e.templateOptions.translatable=!0,e.wrappers=[...e.wrappers||[],"translatable"]),(null===(i=e.templateOptions)||void 0===i?void 0:i.language)?e.templateOptions.language.next(t):e.templateOptions.language=new f.X(t),e.resourceId=this.resourceId,e.resourceName=this.resourceName,e.templateOptions.defaultLocale=this.defaultLocale,e})}submit(){this.form&&this.form.valid&&this.resourceName&&(this.resourceId?this.resourcesService.updateResource(this.resourceName,this.resourceId,this.form.value).subscribe(e=>{this.alertsService.show(n.NK.success,"Resource updated!")}):this.resourcesService.createResource(this.resourceName,this.form.value).subscribe(e=>{this.router.navigate(["/resources",this.resourceName,e.data._id,"edit"]),this.alertsService.show(n.NK.success,"Resource created!")}))}setPrices(){this.router.navigate(["/price-assign",this.resourceId])}initBreadcrumb(){var e,t;this.breadcrumbService.setBreadcrumb([{label:"Home",path:["/dashboard"]},{label:(null===(e=this.resourceInfo)||void 0===e?void 0:e.pluralLabel)||"Resource",path:[`/resources/${this.resourceName}`]},{label:"Edit "+(null===(t=this.resourceInfo)||void 0===t?void 0:t.label)||0,path:[`/resources/${this.resourceName}`]}]),this.breadcrumbService.update()}generatePdf(){this.resourceId&&this.resourcesService.startProcessing(this.resourceId,this.languageControl.value).toPromise().then(e=>{this.isProcessing=!0,this.canDownload=!1})}download(){window.open(this.downloadUrl,"_blank")}ngOnDestroy(){var e;null===(e=this.poll$)||void 0===e||e.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(u.gz),c.Y36(u.F0),c.Y36(S.o),c.Y36(V.w1X),c.Y36(z.b),c.Y36(n.ml),c.Y36(d.p),c.Y36(s.z6))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-edit"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"pt-4","row","sticky-top","bg-white","overflow-hidden","border-bottom","pb-2"],[1,"col-3","mb-0"],[1,"col-9","text-end","row","g-3","m-0"],[1,"form-select","col","me-2","mt-0",3,"formControl"],[3,"value",4,"ngFor","ngForOf"],["type","button","class","btn btn-primary submit-button me-2 col mt-0",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-primary submit-button me-2 col mt-0",3,"click",4,"ngIf"],["type","button","class","btn btn-primary submit-button col mt-0",3,"disabled","click",4,"ngIf"],["class","mt-2",3,"formGroup","ngSubmit",4,"ngIf"],[3,"value"],["type","button",1,"btn","btn-primary","submit-button","me-2","col","mt-0",3,"disabled","click"],[1,"bi","bi-file-pdf-fill"],[1,"bi","bi-play-fill"],["type","button",1,"btn","btn-primary","submit-button","me-2","col","mt-0",3,"click"],[1,"bi","bi-currency-euro"],["type","button",1,"btn","btn-primary","submit-button","col","mt-0",3,"disabled","click"],[1,"bi","bi-save"],[1,"mt-2",3,"formGroup","ngSubmit"],[3,"model","fields","options","form"]],template:function(e,t){1&e&&c.YNc(0,te,12,9,"ng-container",0),2&e&&c.Q6J("ngIf",t.form&&t.fields&&t.resourceInfo)},directives:[o.O5,p.EJ,p.JJ,p.oH,o.sg,p.YN,p.Kr,p._Y,p.JL,p.sg,S.T7],styles:[""]}),e})();var oe=i(6715),se=i(2114),ne=i(6661),re=i(4463),le=i(5790),ae=i(453),ce=i(2207);class ue extends S.fS{constructor(){super(...arguments),this.valueControl=new p.NI(""),this.language="",this.translatable=!1}getDefaultTranslation(){return this.formControl.value[this.to.defaultLocale]}onInit(){var e;this.translatable=!0,this.language=this.to.defaultLocale,(null===(e=this.to)||void 0===e?void 0:e.language)&&this.to.language.subscribe(e=>{if(e){const t=[];this.language=e,this.to.required&&t.push((0,ce.q)(e)),this.formControl.setValidators(t),this.formControl.updateValueAndValidity(),this.updateValue()}}),this.valueControl.valueChanges.subscribe(e=>{let t=this.formControl.value&&"object"==typeof this.formControl.value&&!Array.isArray(this.formControl.value)?Object.assign({},this.formControl.value):{};t[this.language]=e,this.formControl.setValue(t)})}updateValue(){let e="";this.formControl.value&&"object"==typeof this.formControl.value&&!Array.isArray(this.formControl.value)&&this.formControl.value.hasOwnProperty(this.language)&&(e=this.formControl.value[this.language]||""),this.valueControl.setValue(e,{emitEvent:!1})}get displayError(){var e;return null===(e=this.formControl)||void 0===e?void 0:e.invalid}}var de=i(6858);function he(e,t){if(1&e&&c._UZ(0,"textarea",2),2&e){const e=c.oxw();c.ekj("is-invalid",e.displayError),c.Q6J("formControl",e.valueControl)("cols",e.to.cols)("rows",e.to.rows)("formlyAttributes",e.field)}}function pe(e,t){if(1&e&&c._UZ(0,"quill-editor",3),2&e){const e=c.oxw();c.ekj("is-invalid",e.displayError),c.Q6J("formControl",e.valueControl)}}let fe=(()=>{class e extends ue{constructor(){super(...arguments),this.defaultOptions={templateOptions:{cols:1,rows:1}}}ngOnInit(){this.onInit()}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=c.n5z(e)))(i||e)}}(),e.\u0275cmp=c.Xpm({type:e,selectors:[["app-textarea"]],features:[c.qOj],decls:2,vars:2,consts:[["class","form-control",3,"formControl","cols","rows","is-invalid","formlyAttributes",4,"ngIf"],["class","d-block mb-2",3,"formControl","is-invalid",4,"ngIf"],[1,"form-control",3,"formControl","cols","rows","formlyAttributes"],[1,"d-block","mb-2",3,"formControl"]],template:function(e,t){1&e&&(c.YNc(0,he,1,6,"textarea",0),c.YNc(1,pe,1,3,"quill-editor",1)),2&e&&(c.Q6J("ngIf",!(null!=t.to&&t.to.html)),c.xp6(1),c.Q6J("ngIf",null==t.to?null:t.to.html))},directives:[o.O5,p.Fj,p.JJ,p.oH,S.VQ,de.g6],styles:[""],changeDetection:0}),e})();var me=i(8366);function ge(e,t){1&e&&(c.TgZ(0,"span"),c._uU(1,"*"),c.qZA())}function be(e,t){if(1&e&&(c.TgZ(0,"label"),c._uU(1),c.YNc(2,ge,2,0,"span",1),c.qZA()),2&e){const e=c.oxw();c.uIk("for",e.id),c.xp6(1),c.hij(" ",e.to.label," "),c.xp6(1),c.Q6J("ngIf",e.to.required&&!0!==e.to.hideRequiredMarker)}}function ve(e,t){}function we(e,t){if(1&e&&(c.TgZ(0,"button",8),c._UZ(1,"i",9),c.qZA()),2&e){c.oxw();const e=c.MAs(9);c.Q6J("adaptivePosition",!0)("popover",e)}}function _e(e,t){if(1&e&&(c.TgZ(0,"div",10),c._UZ(1,"formly-validation-message",11),c.qZA()),2&e){const e=c.oxw();c.Udp("display","block"),c.xp6(1),c.Q6J("field",e.field)}}function ye(e,t){if(1&e&&(c.TgZ(0,"small",12),c._uU(1),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.Oqu(e.to.description)}}function xe(e,t){if(1&e&&c._UZ(0,"img",14),2&e){const e=c.oxw(2);c.Q6J("src",e.getImg(),c.LSH)}}function Ce(e,t){if(1&e&&c.YNc(0,xe,1,1,"img",13),2&e){const e=c.oxw();c.Q6J("ngIf",e.getImg())}}let Ze=(()=>{class e extends S.n2{getImg(){var e;if(this.formControl.value){const t=((null===(e=this.field.templateOptions)||void 0===e?void 0:e.options)||[]).find(e=>e.value===this.formControl.value);return null==t?void 0:t.img}}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=c.n5z(e)))(i||e)}}(),e.\u0275cmp=c.Xpm({type:e,selectors:[["app-dropdown-wrapper"]],features:[c.qOj],decls:10,vars:6,consts:[[1,"form-group"],[4,"ngIf"],[1,"input-group"],["fieldComponent",""],["class","btn btn-outline-secondary","type","button","triggers","focus","container","body","placement","auto","title","Preview",3,"adaptivePosition","popover",4,"ngIf"],["class","invalid-feedback",3,"display",4,"ngIf"],["class","form-text text-muted",4,"ngIf"],["popTemplate",""],["type","button","triggers","focus","container","body","placement","auto","title","Preview",1,"btn","btn-outline-secondary",3,"adaptivePosition","popover"],[1,"bi","bi-eye"],[1,"invalid-feedback"],[3,"field"],[1,"form-text","text-muted"],["class","d-block w-100",3,"src",4,"ngIf"],[1,"d-block","w-100",3,"src"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c.YNc(1,be,3,3,"label",1),c.TgZ(2,"div",2),c.YNc(3,ve,0,0,"ng-template",null,3,c.W1O),c.YNc(5,we,2,2,"button",4),c.qZA(),c.YNc(6,_e,2,3,"div",5),c.YNc(7,ye,2,1,"small",6),c.qZA(),c.YNc(8,Ce,1,1,"ng-template",null,7,c.W1O)),2&e&&(c.ekj("has-error",t.showError),c.xp6(1),c.Q6J("ngIf",t.to.label&&!0!==t.to.hideLabel),c.xp6(4),c.Q6J("ngIf",t.getImg()),c.xp6(1),c.Q6J("ngIf",t.showError),c.xp6(1),c.Q6J("ngIf",t.to.description))},directives:[o.O5,me.k5,S.u_],styles:[".popover{max-width:600px!important}"]}),e})();function Ne(e,t){1&e&&(c.TgZ(0,"span"),c._uU(1,"*"),c.qZA())}function Ae(e,t){if(1&e&&(c.TgZ(0,"label",10),c._uU(1),c.YNc(2,Ne,2,0,"span",11),c.qZA()),2&e){const e=c.oxw();c.uIk("for",e.id),c.xp6(1),c.hij(" ",e.to.label," "),c.xp6(1),c.Q6J("ngIf",e.to.required&&!0!==e.to.hideRequiredMarker)}}function Ie(e,t){if(1&e&&(c.TgZ(0,"span",12),c._uU(1),c.qZA()),2&e){const e=c.oxw(),t=c.MAs(6);c.Q6J("popover",t)("outsideClick",!0),c.xp6(1),c.Oqu(e.to.defaultLocale.toUpperCase())}}function ke(e,t){if(1&e&&c._UZ(0,"div",14),2&e){const e=c.oxw(2);c.Q6J("innerHtml",e.defaultTranslation,c.oJD)}}function Oe(e,t){1&e&&(c.TgZ(0,"div"),c._uU(1," No preview "),c.qZA())}function Se(e,t){1&e&&(c.TgZ(0,"div"),c._uU(1," No default translation "),c.qZA())}function Te(e,t){if(1&e&&(c.YNc(0,ke,1,1,"div",13),c.YNc(1,Oe,2,0,"div",11),c.YNc(2,Se,2,0,"div",11)),2&e){const e=c.oxw();c.Q6J("ngIf",e.defaultTranslation&&e.defaultTranslation.length>0&&"images"!==e.field.type),c.xp6(1),c.Q6J("ngIf",e.defaultTranslation&&e.defaultTranslation.length>0&&"images"===e.field.type),c.xp6(1),c.Q6J("ngIf",!e.defaultTranslation||0===e.defaultTranslation.length)}}function qe(e,t){if(1&e&&(c.TgZ(0,"span",15),c._uU(1),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.hij(" ",e.language.toUpperCase()," ")}}function Je(e,t){}function Ye(e,t){if(1&e&&(c.TgZ(0,"div",16),c._UZ(1,"formly-validation-message",17),c.qZA()),2&e){const e=c.oxw();c.Udp("display","block"),c.xp6(1),c.Q6J("field",e.field)}}function Me(e,t){if(1&e&&(c.TgZ(0,"small",18),c._uU(1),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.Oqu(e.to.description)}}let Qe=(()=>{class e extends S.n2{constructor(){super(...arguments),this.language=""}get defaultTranslation(){return this.formControl.value[this.to.defaultLocale]}ngOnInit(){var e,t;(null===(e=this.to)||void 0===e?void 0:e.translatable)&&(null===(t=this.to)||void 0===t?void 0:t.language)&&this.to.language.subscribe(e=>{e&&(this.language=e)})}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=c.n5z(e)))(i||e)}}(),e.\u0275cmp=c.Xpm({type:e,selectors:[["app-translatable"]],features:[c.qOj],decls:12,vars:7,consts:[[1,"form-group"],[1,"position-relative","row"],["class","col-8 mt-1",4,"ngIf"],[1,"col-4","mt-1","pb-1","text-end"],["class","language badge bg-secondary ms-2 cursor-pointer bg-light text-dark","placement","left",3,"popover","outsideClick",4,"ngIf"],["popTemplate",""],["class","language badge bg-secondary ms-2",4,"ngIf"],["fieldComponent",""],["class","invalid-feedback",3,"display",4,"ngIf"],["class","form-text text-muted",4,"ngIf"],[1,"col-8","mt-1"],[4,"ngIf"],["placement","left",1,"language","badge","bg-secondary","ms-2","cursor-pointer","bg-light","text-dark",3,"popover","outsideClick"],[3,"innerHtml",4,"ngIf"],[3,"innerHtml"],[1,"language","badge","bg-secondary","ms-2"],[1,"invalid-feedback"],[3,"field"],[1,"form-text","text-muted"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.YNc(2,Ae,3,3,"label",2),c.TgZ(3,"div",3),c.YNc(4,Ie,2,3,"span",4),c.YNc(5,Te,3,3,"ng-template",null,5,c.W1O),c.YNc(7,qe,2,1,"span",6),c.qZA(),c.qZA(),c.YNc(8,Je,0,0,"ng-template",null,7,c.W1O),c.YNc(10,Ye,2,3,"div",8),c.YNc(11,Me,2,1,"small",9),c.qZA()),2&e&&(c.ekj("has-error",t.showError),c.xp6(2),c.Q6J("ngIf",t.to.label&&!0!==t.to.hideLabel),c.xp6(2),c.Q6J("ngIf",(null==t.to?null:t.to.translatable)&&(null==t.to?null:t.to.defaultLocale)&&t.language!==(null==t.to?null:t.to.defaultLocale)),c.xp6(3),c.Q6J("ngIf",(null==t.to?null:t.to.translatable)&&t.language),c.xp6(3),c.Q6J("ngIf",t.showError),c.xp6(1),c.Q6J("ngIf",t.to.description))},directives:[o.O5,me.k5,S.u_],styles:[""]}),e})();function De(e,t){if(1&e&&c._UZ(0,"input",2),2&e){const e=c.oxw();c.ekj("is-invalid",e.displayError),c.Q6J("type",e.type)("formControl",e.valueControl)("formlyAttributes",e.field)}}function Ue(e,t){if(1&e&&c._UZ(0,"input",3),2&e){const e=c.oxw();c.ekj("is-invalid",e.displayError),c.Q6J("formControl",e.valueControl)("formlyAttributes",e.field)}}let Le=(()=>{class e extends ue{ngOnInit(){this.onInit()}get type(){return this.to.type||"text"}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=c.n5z(e)))(i||e)}}(),e.\u0275cmp=c.Xpm({type:e,selectors:[["app-input"]],features:[c.qOj],decls:3,vars:2,consts:[["class","form-control",3,"type","formControl","formlyAttributes","is-invalid",4,"ngIf","ngIfElse"],["numberTmp",""],[1,"form-control",3,"type","formControl","formlyAttributes"],["type","number",1,"form-control",3,"formControl","formlyAttributes"]],template:function(e,t){if(1&e&&(c.YNc(0,De,1,5,"input",0),c.YNc(1,Ue,1,4,"ng-template",null,1,c.W1O)),2&e){const e=c.MAs(2);c.Q6J("ngIf","number"!==t.type)("ngIfElse",e)}},directives:[o.O5,p.Fj,p.JJ,p.oH,S.VQ,p.wV],styles:[""],changeDetection:0}),e})();var Fe=i(2340),Ee=i(3461),Re=i(3815),He=i(4806),Pe=i(3647);function je(e,t){if(1&e&&(c.TgZ(0,"th",6),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.xp6(1),c.Oqu(e.name)}}function Be(e,t){1&e&&c.GkF(0)}function Ve(e,t){if(1&e&&(c.TgZ(0,"div",23),c._uU(1),c.qZA()),2&e){const e=c.oxw().$implicit,t=c.oxw().$implicit,i=c.oxw();c.Q6J("title",i.table.getTranslatedValue(i.getValue(t,e.path))),c.xp6(1),c.Oqu(i.table.getTranslatedValue(i.getValue(t,e.path)))}}function ze(e,t){if(1&e&&(c.TgZ(0,"div",23),c._uU(1),c.qZA()),2&e){const e=c.oxw().$implicit,t=c.oxw().$implicit,i=c.oxw();c.Q6J("title",i.getValue(t,e.path)),c.xp6(1),c.Oqu(i.getValue(t,e.path))}}function Ge(e,t){if(1&e&&(c.TgZ(0,"td"),c.YNc(1,Be,1,0,"ng-container",20),c.YNc(2,Ve,2,2,"ng-template",null,21,c.W1O),c.YNc(4,ze,2,2,"ng-template",null,22,c.W1O),c.qZA()),2&e){const e=t.$implicit,i=c.MAs(3),o=c.MAs(5);c.xp6(1),c.Q6J("ngIf",null==e?null:e.translatable)("ngIfThen",i)("ngIfElse",o)}}function $e(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"tr"),c.TgZ(1,"td",24),c.TgZ(2,"formly-form",25),c.NdJ("modelChange",function(t){c.CHM(e);const i=c.oxw().$implicit;return c.oxw().childChanges(t,i.id)}),c.qZA(),c.qZA(),c.qZA()}if(2&e){const e=c.oxw().$implicit,t=c.oxw();c.xp6(1),c.Q6J("colSpan",t.table.columns.length+3),c.xp6(1),c.Q6J("model",t.getModel(e.id))("fields",t.getHasManyFields(e.id))("form",t.formGroup)("options",t.options)}}function Xe(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"tbody",10),c.TgZ(1,"tr"),c.TgZ(2,"td"),c.TgZ(3,"div",11),c._UZ(4,"i",12),c.qZA(),c.qZA(),c.YNc(5,Ge,6,3,"td",13),c.TgZ(6,"td"),c.TgZ(7,"button",14),c.NdJ("click",function(){const t=c.CHM(e).$implicit;return c.oxw().remove(t.id)}),c._UZ(8,"i",15),c.TgZ(9,"span",16),c._uU(10,"Remove"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(11,"td"),c.TgZ(12,"button",17),c.NdJ("click",function(){const t=c.CHM(e).$implicit;return c.oxw().expand(t.id)}),c._UZ(13,"i",18),c.qZA(),c.qZA(),c.qZA(),c.YNc(14,$e,3,5,"tr",19),c.qZA()}if(2&e){const e=t.$implicit,i=c.oxw();c.xp6(5),c.Q6J("ngForOf",i.table.columns),c.xp6(9),c.Q6J("ngIf",i.isExpanded(e.id))}}let Ke=(()=>{class e extends S.fS{constructor(e,t,i,o){super(),this.changeRef=e,this.modalService=t,this.resourcesService=i,this.tableService=o,this.bsModalRef=null,this.subscriptions=[],this.resourceName=null,this.rows=[],this.sorting={sortBy:"order",sortDir:"asc"},this.formGroup=new p.cw({}),this.expandedSections={},this.defaultLocale=Fe.N.defaultLocale,this.table=new r.i(i,o)}ngOnInit(){var e,t,i,o,s;this.resourceName=(null===(t=null===(e=this.to)||void 0===e?void 0:e.main)||void 0===t?void 0:t.resource)||null,this.table.resourceName=this.resourceName,this.defaultLocale=(null===(i=this.to)||void 0===i?void 0:i.defaultLocale)||Fe.N.defaultLocale,this.loadTable(this.formControl.value||[],this.table,null===(s=null===(o=this.to)||void 0===o?void 0:o.main)||void 0===s?void 0:s.resource,this.sorting),this.subscriptions.push(this.formControl.valueChanges.subscribe(e=>{var t,i;this.loadTable(e,this.table,null===(i=null===(t=this.to)||void 0===t?void 0:t.main)||void 0===i?void 0:i.resource,this.sorting)})),this.subscriptions.push(this.table.onLoaded.subscribe(e=>{e&&this.changeRef.detectChanges()}))}loadTable(e,t,i,o){if(e&&e.length>0){e=e.sort((e,t)=>{const i=(null==e?void 0:e.order)||0,o=(null==t?void 0:t.order)||0;return i<o?-1:i>o?1:0});const n=[];for(const t of e)n.push(t.id);const r=n.join(",");i&&t&&t.loadData(i,new s.CE({resource:i,resourceIds:r.length>0?r:"empty",sorting:o}))}}remove(e){const t=this.formControl.value.filter(t=>t.id!==e);this.formControl.setValue(t)}get columnMode(){return a.hq.flex}getHasManyFields(e){var t,i,o,s,n,r,l,a,c,u;return[{key:"children",type:"hasMany",templateOptions:{label:null===(i=null===(t=this.to)||void 0===t?void 0:t.child)||void 0===i?void 0:i.label,resource:null===(s=null===(o=this.to)||void 0===o?void 0:o.child)||void 0===s?void 0:s.resource,searchBy:null===(r=null===(n=this.to)||void 0===n?void 0:n.child)||void 0===r?void 0:r.searchBy,hideDragHandle:!0,filter:[null===(a=null===(l=this.to)||void 0===l?void 0:l.child)||void 0===a?void 0:a.filter,{column:null===(u=null===(c=this.to)||void 0===c?void 0:c.child)||void 0===u?void 0:u.relationKey,comparator:"=",value:e}]}}]}openModalWithComponent(){var e,t,i,o;const s={resourceName:(null===(t=null===(e=this.to)||void 0===e?void 0:e.main)||void 0===t?void 0:t.resource)||null,filter:null,searchBy:(null===(o=null===(i=this.to)||void 0===i?void 0:i.main)||void 0===o?void 0:o.searchBy)||null,formControl:this.formControl},n=this.formControl.value||[];this.bsModalRef=this.modalService.show(He.R,{initialState:s,class:"modal-lg"}),this.bsModalRef.content.onAddData.subscribe(e=>{this.formControl.setValue([...n,...e])})}drop(e){(0,Ee.bA)(this.table.rows,e.previousIndex,e.currentIndex);const t=this.formControl.value.map(e=>{const t=this.table.rows.findIndex(t=>t.id===e.id);return e.order=-1!==t?t:0,e});this.formControl.setValue(t,{emitEvent:!1})}getValue(e,t){return(0,Re.get)(e,t)}childChanges(e,t){if(e&&(null==e?void 0:e.children)&&(null==e?void 0:e.children.length)>0){const i=this.formControl.value||[],o=i.find(e=>e.id===t);void 0!==o&&(o.children=null==e?void 0:e.children),this.formControl.setValue(i,{emitEvent:!1})}}getModel(e){const t=this.formControl.value.find(t=>t.id===e);return void 0===t||t.hasOwnProperty("children")||(t.children=[]),void 0!==t?t:{}}isExpanded(e){return this.expandedSections.hasOwnProperty(e)||(this.expandedSections[e]=!1),this.expandedSections[e]}expand(e){this.expandedSections.hasOwnProperty(e)||(this.expandedSections[e]=!1);for(const t in this.expandedSections)this.expandedSections.hasOwnProperty(t)&&t!==e&&(this.expandedSections[t]=!1);this.expandedSections[e]=!1===this.expandedSections[e]}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(c.sBO),c.Y36(Pe.tT),c.Y36(s.z6),c.Y36(h.w))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-has-many"]],features:[c._Bn([h.w,s.z6]),c.qOj],decls:17,vars:3,consts:[[1,"card","mt-3"],[1,"card-header","mb-0"],["type","button",1,"btn","btn-success","btn-sm","float-end",3,"click"],[1,"bi","bi-plus-circle"],[1,"card-body","p-0"],["cdkDropList","","id","has-many-cascade-dlist",1,"table","mb-0","w-100",3,"cdkDropListDropped"],["scope","col"],["scope","col",4,"ngFor","ngForOf"],["scope","col",1,"text-end",2,"width","10%"],["cdkDrag","","cdkDragLockAxis","y",4,"ngFor","ngForOf"],["cdkDrag","","cdkDragLockAxis","y"],["cdkDragHandle","",1,"pointer-grab"],[1,"bi","bi-list"],[4,"ngFor","ngForOf"],["type","button",1,"btn","btn-danger","btn-sm","float-end",3,"click"],[1,"bi","bi-trash"],[1,"d-none","d-xl-inline-block"],["type","button",1,"btn",3,"click"],[1,"bi","bi-caret-down-fill"],[4,"ngIf"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"text-truncate","pr-2",2,"max-width","200px",3,"title"],[3,"colSpan"],[3,"model","fields","form","options","modelChange"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c.TgZ(1,"h5",1),c._uU(2),c.TgZ(3,"button",2),c.NdJ("click",function(){return t.openModalWithComponent()}),c._UZ(4,"i",3),c._uU(5," Add "),c.qZA(),c.qZA(),c.TgZ(6,"div",4),c.TgZ(7,"table",5),c.NdJ("cdkDropListDropped",function(e){return t.drop(e)}),c.TgZ(8,"thead"),c.TgZ(9,"tr"),c.TgZ(10,"th",6),c._uU(11,"#"),c.qZA(),c.YNc(12,je,2,1,"th",7),c.TgZ(13,"th",8),c._uU(14,"Actions"),c.qZA(),c._UZ(15,"th",8),c.qZA(),c.qZA(),c.YNc(16,Xe,15,2,"tbody",9),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.xp6(2),c.hij(" ",null==t.to||null==t.to.main?null:t.to.main.label," "),c.xp6(10),c.Q6J("ngForOf",t.table.columns),c.xp6(4),c.Q6J("ngForOf",t.table.rows))},directives:[Ee.Wj,o.sg,Ee.Zt,Ee.Bh,o.O5,S.T7],styles:[""]}),e})();function We(e,t){if(1&e&&c._UZ(0,"input",2),2&e){const e=c.oxw();c.ekj("is-invalid",e.showError),c.Q6J("type",e.type)("formControl",e.formControl)("formlyAttributes",e.field)}}function et(e,t){if(1&e&&c._UZ(0,"input",3),2&e){const e=c.oxw();c.ekj("is-invalid",e.showError),c.Q6J("formControl",e.formControl)("formlyAttributes",e.field)}}const tt=function(){let e=0;const t=new Date;return function(i){const o=(new Date).getTime()-t.getTime(),s=Math.floor(1e3*Math.random());let n;return i=String(i)||"",n="-"+e+"-"+o+"-"+s,e+=1,i+n}}();let it=(()=>{class e extends S.fS{ngOnInit(){if("hidden"===this.type&&!this.formControl.value){const e=tt("pricelist_");this.formControl.setValue(e)}}get type(){return this.to.type||"text"}}return e.\u0275fac=function(){let t;return function(i){return(t||(t=c.n5z(e)))(i||e)}}(),e.\u0275cmp=c.Xpm({type:e,selectors:[["app-custom-input"]],features:[c.qOj],decls:3,vars:2,consts:[["class","form-control",3,"type","formControl","formlyAttributes","is-invalid",4,"ngIf","ngIfElse"],["numberTmp",""],[1,"form-control",3,"type","formControl","formlyAttributes"],["type","number",1,"form-control",3,"formControl","formlyAttributes"]],template:function(e,t){if(1&e&&(c.YNc(0,We,1,5,"input",0),c.YNc(1,et,1,4,"ng-template",null,1,c.W1O)),2&e){const e=c.MAs(2);c.Q6J("ngIf","number"!==t.type)("ngIfElse",e)}},directives:[o.O5,p.Fj,p.JJ,p.oH,S.VQ,p.wV],styles:[""],changeDetection:0}),e})();const ot=[{path:":name",component:B},{path:":name/create",component:ie},{path:":name/:id/edit",component:ie}];let st=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[o.ez,a.xD,u.Bz.forChild(ot),ae.f.forRoot(),O.forRoot(),oe.z$,p.UX,S.X0.forChild({extras:{lazyRender:!0},wrappers:[{name:"translatable",component:Qe},{name:"panel",component:se.Z},{name:"layout",component:Ze}],types:[{name:"images",component:ne.Pw,wrappers:["form-field"]},{name:"repeat",component:re.$},{name:"hasMany",component:le.a},{name:"hasManyCascade",component:Ke},{name:"translatable-textarea",component:fe},{name:"translatable-input",component:Le},{name:"input",component:it}]})]]}),e})()}}]);